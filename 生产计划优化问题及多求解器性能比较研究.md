# 生产计划优化问题及多求解器性能比较研究

## 问题描述与建模思路

我们选取**生产计划与库存管理**这一贴近实际的优化场景。假设一家工厂需要在多个时期内生产某产品以满足已知需求，并权衡生产成本、库存成本和生产线开停机成本。该问题在现实中非常常见，例如月度生产计划：每月需求已知，工厂可以选择当月生产并库存以满足未来需求，但每次开动生产线会产生固定开机成本。

**情景描述：** 工厂面临一个规划周期（例如未来12个月）的产品需求。每个月末需要满足当月累计的产品需求量。工厂每月可以生产一定数量产品（设有最大产能限制），未满足需求可通过之前月份生产的库存来供应。存在三类成本：每生产1单位产品的**生产成本**，每单位产品每月的**库存持有成本**（存入库存过月产生费用），以及**固定开机成本**（当月如果有生产则支付一次固定费用，无论产量多少）。目标是在满足各月需求的前提下，最小化总成本。该规划属于一个多阶段决策问题，需要决定每月的生产量和库存量，以及是否在该月开启生产。

**模型抽象：** 可以将上述情景转化为一个中等规模的数学规划模型：

### 决策变量
- **x_t**：表示第 t 月生产量
- **s_t**：表示第 t 月末库存量  
- **y_t**：表示第 t 月是否安排生产的0-1变量（y_t=1 则有生产，y_t=0 表示停产）
- **规划周期**：t = 1, 2, ..., T（例如 T=12 个月）

### 目标函数
最小化总成本，包括生产成本、库存成本和开机固定成本：

```
minimize: ∑(t=1 to T) [c_prod × x_t + c_hold × s_t + c_setup × y_t]
```

其中：
- **c_prod**：单位生产成本
- **c_hold**：单位库存每期持有成本  
- **c_setup**：每次开机的固定成本

### 约束条件

#### 1. 需求约束
每月期初库存加当月生产须满足当月需求并留下期末库存：

```
s_{t-1} + x_t = d_t + s_t,  对所有 t = 1, 2, ..., T
```

其中：
- **d_t**：第 t 月需求量
- **s_0**：初始库存（通常假定 s_0 = 0）

该约束确保满足需求的同时更新库存水平。

#### 2. 产能约束  
每月生产量有限制：

```
0 ≤ x_t ≤ M × y_t
```

其中：
- **M**：产能上限
- 当 y_t = 0 时，x_t 被迫为 0
- 当 y_t = 1 时，x_t 最多为 M

该约束将是否生产与生产量关联起来：只有当 y_t = 1 时生产量才能为正，否则 y_t = 0 会强制 x_t = 0。

#### 3. 变量范围
```
x_t, s_t ≥ 0
y_t ∈ {0, 1}
```

库存和生产量不可为负，y_t 是布尔决策变量。

### 模型特性

上述模型属于**混合整数线性规划**（MILP），因为含有0-1整数变量和线性约束、线性目标。这一模型规模适中：

- **变量数量**：规划12个月有约24个连续变量和12个整数变量
- **约束数量**：约24条约束
- **扩展性**：通过增加时间维度或产品种类可扩展模型规模

## 模型变体

该实际问题还可以引申出不同类型的优化模型，方便使用多种求解器求解：

### 线性规划 (LP) 版本

**特点**：去掉固定开机成本和 y_t 变量

**目标函数**：
```
minimize: ∑(t=1 to T) [c_prod × x_t + c_hold × s_t]
```

**产能约束简化为**：
```
0 ≤ x_t ≤ M
```

此时模型退化为线性规划，通常每期都会生产，问题变为在产能和库存成本权衡下的线性优化。

### 二次规划 (QP) 版本

**特点**：为强调生产平稳性，在目标函数中加入生产平滑项

**目标函数**：
```
minimize: ∑(t=1 to T) [c_prod × x_t + c_hold × s_t] + λ × ∑(t=2 to T) (x_t - x_{t-1})²
```

其中：
- **λ**：平滑性权重参数
- **(x_t - x_{t-1})²**：二次惩罚项，避免产量大幅波动

这样目标函数成为二次型凸函数，约束仍为线性，形成凸二次规划问题。

### 非线性规划 (NLP) 版本

**特点**：考虑更复杂的非线性成本函数

**可能的非线性形式**：
- 生产效率随产量非线性变化
- 规模经济效应：`cost(x) = a × x + b × x^1.5`
- 高负荷生产的额外损耗成本

**目标函数示例**：
```
minimize: ∑(t=1 to T) [f(x_t) + c_hold × s_t + c_setup × y_t]
```

其中 f(x_t) 是关于生产量的非线性成本函数。

## 求解器适用性

| 模型类型 | 适用求解器 | 特点 |
|---------|------------|------|
| MILP | CBC, Gurobi, CPLEX | 处理整数变量，全局最优解 |
| LP | CBC, GLPK, 单纯形法 | 快速求解，多面体最优解 |
| QP | OSQP, CLARABEL, Gurobi | 凸二次优化，高效数值算法 |
| NLP | IPOPT, SLSQP, COBYLA | 非线性优化，局部最优解 |

## 总结

通过上述不同版本，同一个实际问题可以由不同类型的优化模型刻画，从而适配多种优化求解器：

1. **MILP版本**：最贴近现实，考虑开机决策
2. **LP版本**：计算最快，适合快速决策
3. **QP版本**：平衡成本与平稳性
4. **NLP版本**：考虑复杂的非线性效应

这为比较不同求解器在相同问题背景下的性能表现提供了良好的基础，也为实际应用中选择合适的模型和求解器提供了参考。